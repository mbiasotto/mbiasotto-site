# ===========================================
# .HTACCESS ULTRA-MINIMALISTA (MÁXIMA COMPATIBILIDADE)
# ===========================================

RewriteEngine On

# ===========================================
# 1. URLs LIMPAS (ESSENCIAL)
# ===========================================

# Processar URLs sem extensão .php
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^([^\.]+)$ $1.php [NC,L]

# Redirecionar .php para URL limpa  
RewriteCond %{THE_REQUEST} /([^.]+)\.php [NC]
RewriteRule ^ /%1? [NC,L,R=301]

# ===========================================
# 2. REDIRECTS BÁSICOS SEO
# ===========================================

Redirect 301 /index.html /
Redirect 301 /home /

# redirect do site antigo
Redirect 301 /servicos.php /servicos
Redirect 301 /trabalhos-realizados.php /servicos
Redirect 301 /servicos/marketing-de-busca-seo-sem.php /servicos
Redirect 301 /programador-php-freelancer.php /programador-php-freelancer

# ===========================================
# 3. COMPRESSÃO AVANÇADA (22 KiB savings)
# ===========================================

<IfModule mod_deflate.c>
    # Compressão para todos os recursos de texto
    AddOutputFilterByType DEFLATE text/plain
    AddOutputFilterByType DEFLATE text/html
    AddOutputFilterByType DEFLATE text/xml
    AddOutputFilterByType DEFLATE text/css
    AddOutputFilterByType DEFLATE text/javascript
    AddOutputFilterByType DEFLATE application/xml
    AddOutputFilterByType DEFLATE application/xhtml+xml
    AddOutputFilterByType DEFLATE application/rss+xml
    AddOutputFilterByType DEFLATE application/javascript
    AddOutputFilterByType DEFLATE application/x-javascript
    AddOutputFilterByType DEFLATE application/json
    AddOutputFilterByType DEFLATE application/ld+json
    AddOutputFilterByType DEFLATE application/atom+xml
    AddOutputFilterByType DEFLATE image/svg+xml
    
    # Excluir arquivos já comprimidos
    SetEnvIfNoCase Request_URI \
        \.(?:gif|jpe?g|png|webp|zip|gz|bz2|sit|rar)$ no-gzip dont-vary
</IfModule>

# ===========================================
# 4. CACHE POLICY (Fix static assets warning)
# ===========================================

<IfModule mod_expires.c>
    ExpiresActive On
    
    # Imagens (1 ano)
    ExpiresByType image/jpg "access plus 1 year"
    ExpiresByType image/jpeg "access plus 1 year"
    ExpiresByType image/gif "access plus 1 year"
    ExpiresByType image/png "access plus 1 year"
    ExpiresByType image/webp "access plus 1 year"
    ExpiresByType image/svg+xml "access plus 1 year"
    ExpiresByType image/x-icon "access plus 1 year"
    
    # CSS e JavaScript (1 mês)
    ExpiresByType text/css "access plus 1 month"
    ExpiresByType application/javascript "access plus 1 month"
    ExpiresByType text/javascript "access plus 1 month"
    
    # Fontes (1 ano)
    ExpiresByType font/woff "access plus 1 year"
    ExpiresByType font/woff2 "access plus 1 year"
    ExpiresByType application/font-woff "access plus 1 year"
    ExpiresByType application/font-woff2 "access plus 1 year"
    
    # HTML (1 dia)
    ExpiresByType text/html "access plus 1 day"
    
    # Outros arquivos (1 semana)
    ExpiresDefault "access plus 1 week"
</IfModule>

# Cache headers alternativos (caso mod_expires não esteja disponível)
<IfModule mod_headers.c>
    # CSS e JS
    <FilesMatch "\.(css|js)$">
        Header set Cache-Control "max-age=2592000, public"
    </FilesMatch>
    
    # Imagens
    <FilesMatch "\.(jpg|jpeg|png|gif|webp|svg|ico)$">
        Header set Cache-Control "max-age=31536000, public"
    </FilesMatch>
    
    # Fontes
    <FilesMatch "\.(woff|woff2|ttf|eot)$">
        Header set Cache-Control "max-age=31536000, public"
    </FilesMatch>
    
    # Desabilitar ETag para melhor performance
    Header unset ETag
    FileETag None
</IfModule>

# ===========================================
# 5. PÁGINA 404
# ===========================================

ErrorDocument 404 /404.php 